{% extends "base.html" %}
{% block content %}
<div class="container" ng-app="mandisApp" ng-controller="mandisCtrl">

  <div class="row">
    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Věta</h3>
        </div>
        <div class="panel-body">
          <code><span ng-repeat="pos in utt">{[ pos.word ]} </span></code>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-8">
      <div class="panel panel-primary">
        <div class="panel-heading">
          <h3 class="panel-title">Desambiguace</h3>
        </div>
        <div class="panel-body">
          <table class="table table-condensed">
            <thead>
              <tr>
                <th>word</th>
                <th>lemma</th>
                <th>tag</th>
                <th>označit</th>
                <th>poznámka</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-class="{highlight: pos.flag}"
                  ng-repeat="pos in utt">

                <td>{[ pos.word ]}</td>

                <td ng-if="pos.pool.length > 1">
                  <select ng-model="pos.lemma"
                          ng-options="idx as lemtag.lemma for (idx, lemtag) in pos.pool">
                  </select>
                </td>
                <td ng-if="pos.pool.length == 1">
                  {[ pos.pool[pos.lemma = 0].lemma ]}
                </td>

                <td ng-if="pos.pool[pos.lemma].tags.length > 1">
                  <select ng-model="pos.tag"
                          ng-change="$parent.$parent.helpTag = pos.pool[pos.lemma].tags[pos.tag]"
                          ng-options="idx as tag for (idx, tag) in pos.pool[pos.lemma].tags">
                  </select>
                </td>
                <td ng-if="pos.pool[pos.lemma].tags.length == 1">
                  {[ pos.pool[pos.lemma].tags[pos.tag = 0] ]}
                </td>
                <td ng-if="!pos.pool[pos.lemma].tags.length">
                  <em>&mdash; vyberte nejprve lemma &mdash;</em>
                </td>

                <td>
                  <input type="checkbox" ng-model="pos.flag">
                </td>

                <td>
                  <textarea ng-if="pos.flag" ng-model="pos.note"></textarea>
                </td>
          </table>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="col-md-4" ng-show="helpTag">
      <div class="panel panel-success">
        <div class="panel-heading">
          <h3 class="panel-title">Nápověda k tagu {[ helpTag ]}</h3>
        </div>
        <div class="panel-body">
          <table class="table table-condensed table-striped">
            <tr ng-repeat="(idx, pos) in postag">
              <td><b>{[ pos.label ]}</b></td>
              <td><code>{[ helpTag[idx] ]}</code></td>
              <td>{[ pos[helpTag[idx]] ]}</td>
            </tr>
          </table>
        </div>
      </div>
    </div>

  </div>

  <!-- <pre>
  {[ utt | json ]}
  </pre> -->

</div>
{% endblock %}
